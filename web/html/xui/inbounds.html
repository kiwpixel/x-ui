openAddInbound() {
    inModal.show({
        title: '添加入站',
        okText: '添加',
        content: `
            <a-form-item label="批量端口（多个端口用逗号分隔，或使用连字符表示范围，如 8080-8085）">
                <a-input v-model="batchPorts"></a-input>
            </a-form-item>
            <a-button @click="batchAddInbound">批量添加</a-button>
        `,
        confirm: async (inbound, dbInbound) => {
            inModal.loading();
            await this.addInbound(inbound, dbInbound);
            inModal.close();
        }
    });
},
methods: {
    batchAddInbound() {
        const ports = this.parsePorts(this.batchPorts);
        if (ports.length === 0) {
            this.$message.error('无效的端口输入');
            return;
        }
        const baseInbound = this.getBaseInbound();
        const inbounds = [];
        ports.forEach(port => {
            const inbound = {...baseInbound };
            inbound.port = port;
            inbounds.push(inbound);
        });
        this.submit('/xui/inbound/addBatch', { inbounds }, true);
    },
    parsePorts(input) {
        const ports = [];
        const parts = input.split(',');
        parts.forEach(part => {
            if (part.includes('-')) {
                const [start, end] = part.split('-').map(Number);
                for (let i = start; i <= end; i++) {
                    ports.push(i);
                }
            } else {
                const port = parseInt(part);
                if (!isNaN(port)) {
                    ports.push(port);
                }
            }
        });
        return ports;
    },
    getBaseInbound() {
        // 获取基础入站配置
        return {
            listen: this.inbound.listen,
            protocol: this.inbound.protocol,
            settings: this.inbound.settings.toString(),
            streamSettings: this.inbound.stream.toString(),
            sniffing: this.inbound.canSniffing() ? this.inbound.sniffing.toString() : '{}'
        };
    }
}
